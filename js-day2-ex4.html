<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>EX4</title>
    </head>
    <body>
        <table class="table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Year</th>
                    <th>Make</th>
                    <th>Model</th>
                    <th id="price-header">Price</th>
                </tr>
            </thead>
            <tbody id="tbody"></tbody>
        </table>
        <div class="wrapper">
            <input id="input" type="text" placeholder="Price" />
            <button id="btn">Click me</button>
            <button id="clear-btn">Clear</button>
        </div>

        <script>
            const cars = [
                { id: 1, year: 1997, make: "Ford", model: "E350", price: 3000 },
                { id: 2, year: 1999, make: "Chevy", model: "Venture", price: 4900 },
                { id: 3, year: 2000, make: "Chevy", model: "Venture", price: 5000 },
                { id: 4, year: 1996, make: "Jeep", model: "Grand Cherokee", price: 4799 },
                { id: 5, year: 2005, make: "Volvo", model: "V70", price: 44799 },
            ];

            let toggle = false;

            updateCars(cars);

            document.querySelector("load", init());

            function init() {
                // filter button
                document.querySelector("#btn").addEventListener("click", (e) => {
                    e.preventDefault();
                    const value = document.querySelector("#input").value;
                    filterList(value);
                });

                // clear button
                document.querySelector("#clear-btn").addEventListener("click", (e) => {
                    document.querySelector("#input").value = "";
                    updateCars(cars);
                });

                // price sorting
                document.querySelector("#price-header").addEventListener("click", (e) => {
                    sortList();
                });
            }

            function filterList(value) {
                const list = cars.filter((car) => car.price <= value);
                updateCars(list);
            }

            function sortList() {
                const sortedList = cars.sort((a, b) => {
                    return a.price - b.price;
                });

                if (!toggle) {
                    updateCars(sortedList);
                    toggle = true;
                } else {
                    sortedList.reverse();
                    toggle = false;
                }

                updateCars(sortedList);
            }

            function updateCars(cars) {
                const tableBody = document.querySelector("#tbody");

                tableBody.innerHTML = cars
                    .map(
                        (car) => `<tr>
                            <td>${car.id}</td>
                            <td>${car.year}</td>
                            <td>${car.make}</td>
                            <td>${car.model}</td>
                            <td>${car.price}</td>
                            </tr>`
                    )
                    .join("");
            }
        </script>
    </body>
</html>
